define("text",["module"],function(e){"use strict";var t,i,n,r,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,d=c&&location.protocol&&location.protocol.replace(/\:/,""),f=c&&location.hostname,u=c&&(location.port||void 0),h={},p=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=o[t];try{e=new ActiveXObject(i)}catch(n){}if(e){o=[i];break}}return e},parseName:function(e){var t,i,n,r=!1,s=e.indexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==s&&(!o||s>1)?(t=e.substring(0,s),i=e.substring(s+1,e.length)):t=e,n=i||t,s=n.indexOf("!"),-1!==s&&(r="strip"===n.substring(s+1),n=n.substring(0,s),i?i=n:t=n),{moduleName:t,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,r){var s,o,a,l=t.xdRegExp.exec(e);return l?(s=l[2],o=l[3],o=o.split(":"),a=o[1],o=o[0],!(s&&s!==i||o&&o.toLowerCase()!==n.toLowerCase()||(a||o)&&a!==r)):!0},finishLoad:function(e,i,n,r){n=i?t.strip(n):n,p.isBuild&&(h[e]=n),r(n)},load:function(e,i,n,r){if(r.isBuild&&!r.inlineText)return void n();p.isBuild=r.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),a=i.toUrl(o),l=p.useXhr||t.useXhr;return 0===a.indexOf("empty:")?void n():void(!c||l(a,d,f,u)?t.get(a,function(i){t.finishLoad(e,s.strip,i,n)},function(e){n.error&&n.error(e)}):i([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,n)}))},write:function(e,i,n,r){if(h.hasOwnProperty(i)){var s=t.jsEscape(h[i]);n.asModule(e+"!"+i,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,i,n,r,s){var o=t.parseName(i),a=o.ext?"."+o.ext:"",l=o.moduleName+a,c=n.toUrl(o.moduleName+a)+".js";t.load(l,n,function(i){var n=function(e){return r(c,e)};n.asModule=function(e,t){return r.asModule(e,c,t)},t.write(e,l,n,s)},s)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var r=i.readFileSync(e,"utf8");0===r.indexOf("\ufeff")&&(r=r.substring(1)),t(r)}catch(s){n(s)}}):"xhr"===p.env||!p.env&&t.createXhr()?t.get=function(e,i,n,r){var s,o=t.createXhr();if(o.open("GET",e,!0),r)for(s in r)r.hasOwnProperty(s)&&o.setRequestHeader(s.toLowerCase(),r[s]);p.onXhr&&p.onXhr(o,e),o.onreadystatechange=function(t){var r,s;4===o.readyState&&(r=o.status,r>399&&600>r?(s=new Error(e+" HTTP status: "+r),s.xhr=o,n(s)):i(o.responseText),p.onXhrComplete&&p.onXhrComplete(o,e))},o.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,r="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),r)),l="";try{for(i=new java.lang.StringBuffer,n=a.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(o),i.append(n);l=String(i.toString())}finally{a.close()}t(l)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,o,a,l={};s&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),i.init(a,1,0,!1),o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),o.init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),l),o.close(),i.close(),t(l.value)}catch(c){throw new Error((a&&a.path||"")+": "+c)}}),t}),define("text!camera/selfieWidget.html",[],function(){return'<div id="selfie-widget">\n    <div id="selfie-liveView">\n        <div id="selfie-video-bg"></div>\n        <video id="selfie-video"></video>\n        <div class="selfie-snap" id="selfie-snap">\n            <div id="icon" alt="Snap"></div>\n        </div>\n    </div>\n    <div id="selfie-gallery">\n        <div class="polaroid">\n            <img id="selfie-photo" />\n        </div>\n    </div>\n</div>\n<canvas id="selfie-canvas"></canvas>\n'}),define("camera/utils",["require","exports","module"],function(e,t,i){"use strict";function n(e){for(var t=window.atob(e),i=t.length,n=new Uint8Array(i),r=0;i>r;r++)n[r]=t.charCodeAt(r);return new o(n.buffer)}function r(e,t,i){s.writeFile(e,t,{encoding:null},i)}var s=brackets.getModule("fileSystemImpl"),o=brackets.getModule("filesystem/impls/filer/BracketsFiler").Buffer;t.base64ToBuffer=n,t.persist=r}),define("camera/interface",["require","exports","module","text!camera/selfieWidget.html","camera/utils"],function(e,t,i){"use strict";function n(){$("#selfie-video-bg").addClass("on"),s.play();var e=setTimeout(function(){clearTimeout(e),$("#selfie-video-bg").removeClass("on")},105)}function r(e){this.camera=e,this.video=e.video,this.photo=e.photo,this.canvas=this.photo.canvas}var s,o=e("text!camera/selfieWidget.html"),a=e("camera/utils").base64ToBuffer,l=320;r.prototype.init=function(){var e=$("#selfie-container");$("#selfie-allow-access").remove(),e.prepend(o),this.video["interface"]=document.getElementById("selfie-video"),this.photo["interface"]=document.getElementById("selfie-photo"),this.canvas["interface"]=document.getElementById("selfie-canvas"),this.snapButton=document.getElementById("selfie-snap"),this.saveButton=document.getElementById("selfie-use"),this.saveButton.style.display="initial",s||(s=new Audio("./extensions/default/BrambleUrlCodeHints/camera/camera-shutter-click-08.mp3"))},r.prototype.setCameraSize=function(e){this._height=e,this.video["interface"].setAttribute("height",e),this.video["interface"].setAttribute("width",l),this.canvas["interface"].setAttribute("height",e),this.canvas["interface"].setAttribute("width",l)},r.prototype.enableSnapIcon=function(){var e=this;this.snapButton.addEventListener("click",function(t){t.preventDefault(),e.saveButton.removeAttribute("disabled"),n(),e.snapPhoto()})},r.prototype.snapPhoto=function(){function e(){var e=t.photo.data;if(!e)return t.camera.fail();var i=/^data:image\/png;base64,(.+)/.exec(e)[1];t.camera.savePhoto(a(i))}if(!this._height)return this.camera.fail();var t=this,i=this.canvas["interface"].getContext("2d");this.canvas["interface"].width=l,this.canvas["interface"].height=this._height,i.drawImage(this.video["interface"],0,0,l,this._height),this.photo.update(),this.saveButton.removeEventListener("click",e),this.saveButton.addEventListener("click",e)},r.prototype.getWidth=function(){return l},i.exports=r}),define("camera/video",["require","exports","module"],function(e,t,i){"use strict";function n(e){this.context=e,this.streaming=!1}var r=window.URL||window.webkitURL;n.prototype.play=function(e){var t=this,i=this.context["interface"];i.init();var n=this["interface"],s=function(){n.removeEventListener("playing",s),t.startStream()},o=function(){n.removeEventListener("pause",o),t.endStream()},a=function(e){n.removeEventListener("playing",s),n.removeEventListener("pause",o),t.endStream(),this.context.fail(new Error("Failed to load "+e.target.src))};this.stream=e,n.src=r.createObjectURL(e),n.addEventListener("playing",s,!1),n.addEventListener("pause",o),n.addEventListener("error",a),i.enableSnapIcon(),n.play()},n.prototype.startStream=function(){if(!this.streaming){var e=this.context["interface"].getWidth(),t=this["interface"].videoHeight/(this["interface"].videoWidth/e);isNaN(t)&&(t=e/(4/3)),this.context["interface"].setCameraSize(t),this.streaming=!0}},n.prototype.endStream=function(){if(r.revokeObjectURL(this["interface"].src),this.stream){var e=this.stream.getVideoTracks?this.stream.getVideoTracks()[0]:null;e&&e.stop(),this.stream=null,this.streaming=!1}},i.exports=n}),define("camera/photo",["require","exports","module"],function(e,t,i){"use strict";function n(e){this.context=e,this.canvas={},this.data=null}n.prototype.update=function(){this.data=this.canvas["interface"].toDataURL("image/png"),this["interface"].setAttribute("src",this.data)},i.exports=n}),define("camera/index",["require","exports","module","camera/interface","camera/video","camera/photo","camera/utils"],function(e,t,i){"use strict";function n(e,t){this._deferred=e,this.savePath=t,this.video=new a(this),this.photo=new l(this),this["interface"]=new o(this)}var r=brackets.getModule("command/CommandManager"),s=brackets.getModule("command/Commands"),o=e("camera/interface"),a=e("camera/video"),l=e("camera/photo"),c=e("camera/utils").persist,d=window.navigator,f=d.getUserMedia||d.webkitGetUserMedia||d.mozGetUserMedia||d.msGetUserMedia;n.isSupported=!!f,n.prototype.start=function(){var e=this;f.call(d,{video:!0,audio:!1},function(t){e.video.play(t)},function(t){e.fail(t)})},n.prototype.savePhoto=function(e){var t=this;c(this.savePath,e,function(e){return e?t.fail(e):(r.execute(s.FILE_REFRESH),void t.success(t.savePath))})},n.prototype.success=function(){this._deferred.resolve.apply(this._deferred,arguments)},n.prototype.fail=function(e){this._deferred.reject(e)},i.exports=n}),define("text!dialog.html",[],function(){return'<div class="template modal">\n    <div class="modal-header">\n        <h1 class="dialog-title" id="dialog-title">Take a Selfie</h1>\n    </div>\n    <div class="modal-body">\n        <div id="selfie-container" class="dialog-message">\n        <p id="selfie-allow-access">\n            Thimble needs you to <span class="emphasis">Allow</span> permission to your camera (at the top of your browser).  <br />\n            Photos won\'t be shared unless you publish this project.\n        </p>\n        </div>\n    </div>\n    <div class="modal-footer">\n        {{#buttons}}\n        <button class="dialog-button btn {{className}}" data-button-id="{{dataId}}" id="{{id}}">{{{text}}}</button>\n        {{/buttons}}\n    </div>\n</div>\n'}),define("camera-dialog",["require","exports","module","text!dialog.html","camera/index"],function(e,t,i){"use strict";function n(e){this._dialog=null,this.camera=null,this.savePath=e}var r=brackets.getModule("widgets/Dialogs"),s=brackets.getModule("thirdparty/mustache/mustache"),o=e("text!dialog.html"),a=e("camera/index"),l="cancel",c="ok",d="primary",f="left",u={buttons:[{className:f,dataId:l,text:"Cancel"},{className:d,dataId:c,text:"Select Selfie",id:"selfie-use"}]};n.prototype.show=function(){var e=this,t=new $.Deferred;return o=s.render(o,u),this._dialog=r.showModalDialogUsingTemplate(o),$("#selfie-use").attr("disabled",!0),$("#selfie-close").on("click",function(){e.close(),t.resolve()}),this.camera=new a(t,this.savePath),this.camera.start(),t.promise()},n.prototype.close=function(){this.camera=null,this._dialog&&(this._dialog.close(),this._dialog=null)},i.exports=n}),define("selfie",["require","exports","module","camera-dialog"],function(e,t,i){"use strict";function n(e){var t=l.project("root");f.readdir(t,function(t,i){if(t)return e(t);var n=0;i.forEach(function(e){var t,i=/selfie(\d*)\.png/.exec(e);i&&(t=Number(i[1]),t>n&&(n=t))});var r=p+(n+1)+".png";e(null,r)})}function r(){function e(e){var i=l.project("root").replace(/\/?$/,"/"),n=d.join(i,e),r=new u(n);r.show().done(function(e){e&&(e=a.getRelativeFilename(i,e)),t.resolve(e)}).fail(function(e){t.reject(e)}).always(function(){r.close(),r=null})}var t=new $.Deferred;return n(function(i,n){return i?(console.error("[Selfie error] ",i),t.reject()):void e(n)}),t.promise()}function s(){o.register(m,g,r)}var o=brackets.getModule("command/CommandManager"),a=brackets.getModule("file/FileUtils"),l=brackets.getModule("bramble/StartupState"),c=brackets.getModule("filesystem/impls/filer/BracketsFiler"),d=c.Path,f=c.fs(),u=e("camera-dialog"),h="Take a Selfie...",p="selfie",m="Take a Selfie",g="bramble.selfie";t.addSelfieCommand=s,t.takeSelfie=r,t.label=h}),define("text!data.json",[],function(){return'{\n    "htmlAttrs": {\n        "href":         { "attribOption": [] },\n        "src":          { "attribOption": [] }\n    }\n}\n'}),define("main",["require","exports","module","camera/index","selfie","text!data.json"],function(e,t,i){"use strict";function n(){}function r(){o&&o.cachedHints&&o.imageUrl!==o.cachedHints.imageUrl&&(o.cachedHints=null)}function s(){o&&o.cachedHints&&o.cachedHints.deferred&&"pending"!==o.cachedHints.deferred.state()&&(o.cachedHints=null)}var o,a,l,c=brackets.getModule("utils/AppInit"),d=brackets.getModule("editor/CodeHintManager"),f=brackets.getModule("language/CSSUtils"),u=brackets.getModule("filesystem/FileSystem"),h=brackets.getModule("file/FileUtils"),p=brackets.getModule("language/HTMLUtils"),m=brackets.getModule("project/ProjectManager"),g=brackets.getModule("utils/ExtensionUtils"),v=brackets.getModule("editor/EditorManager"),x=brackets.getModule("filesystem/impls/filer/FilerUtils").Path,y=brackets.getModule("filesystem/impls/filer/lib/content"),b=e("camera/index"),w=e("selfie"),S=e("text!data.json"),H=["css","text/x-less","text/x-scss"];g.loadStyleSheet(i,"style.css"),n.prototype._getUrlList=function(e){var t,i,n,r,s,o,a="",l=[],c=[];if(i=this.editor&&this.editor.document,!i||!i.file)return l;if(n=h.getDirectoryPath(i.file.fullPath),r=window.PathUtils.parseUrl(e.queryStr),r&&(a=r.directory),o=a.length>0&&"/"===a[0]?m.getProjectRoot().fullPath+decodeURI(a).substring(1):n+decodeURI(a),this.cachedHints&&(this.cachedHints.query&&this.cachedHints.query.tag===e.tag&&this.cachedHints.query.attrName===e.attrName&&this.cachedHints.queryDir===a&&this.cachedHints.docDir===n||(this.cachedHints=null)),!this.cachedHints)return t=u.getDirectoryForPath(o),s=this,s.cachedHints&&s.cachedHints.deferred&&s.cachedHints.deferred.reject(),s.cachedHints={},s.cachedHints.deferred=$.Deferred(),s.cachedHints.unfiltered=[],s.cachedHints.imageUrl=s.imageUrl,t.getContents(function(t,i){var r,o,l;t||(i.forEach(function(e){m.shouldShow(e)&&(o=a+e._name,e._isDirectory||c.push(o))}),s.cachedHints.unfiltered=c,s.cachedHints.query=e,s.cachedHints.queryDir=a,s.cachedHints.docDir=n,"rejected"!==s.cachedHints.deferred.state()&&(r=s.cachedHints.deferred,l=s._getUrlList(e),l instanceof Array?r.resolveWith(s,[l]):(r&&"pending"===r.state()&&r.reject(),s.cachedHints.deferred&&"pending"===s.cachedHints.deferred.state()&&(s.cachedHints.deferred.reject(),s.cachedHints.deferred=null))))}),s.cachedHints.deferred;c=this.cachedHints.unfiltered,"."===r.filename?l.push(a+"."):".."===r.filename&&l.push(a+"..");var d=this.imageUrl;return c.forEach(function(e){d?y.isImage(x.extname(e))&&l.push(e):l.push(e)}),l.sort(),d&&b.isSupported&&l.push(w.label),l},n.prototype._getUrlHints=function(e){var t=[];return-1===e.queryStr.indexOf("?")&&(this.closeOnSelect=!1,t=this._getUrlList(e)),t},n.prototype.hasHints=function(e,t){var i=e.getModeForSelection();return"html"===i?this.hasHtmlHints(e,t):H.indexOf(i)>-1?this.hasCssHints(e,t):!1},n.prototype.hasCssHints=function(e,t){this.editor=e;var i=this.editor.getCursorPos();this.info=f.getInfoAtPos(e,i);var n=this.info.name;if(this.info.context!==f.PROP_VALUE)return!1;"background"===n||"background-image"===n||"list-style-image"===n?this.imageUrl=!0:this.imageUrl=!1,r();var s,o="";for(s=0;s<=this.info.index&&s<this.info.values.length;s++)o+=s<this.info.index?this.info.values[s]:this.info.values[s].substring(0,this.info.offset);return o.match(/^\s*url\(/i)?!0:!1},n.prototype.hasHtmlHints=function(e,t){var i,n,s;if(this.editor=e,i=p.getTagInfo(e,e.getCursorPos()),n=null,s=i.position.tokenType,"img"===i.tagName?this.imageUrl=!0:this.imageUrl=!1,r(),s===p.ATTR_VALUE&&l[i.attr.name]){n=i.position.offset>=0?i.attr.value.slice(0,i.position.offset):"";var o=this._getUrlHints({queryStr:n});if(o instanceof Array){var a,c=!1;for(n=n.toLowerCase(),a=0;a<o.length;a++)if(0===o[a].toLowerCase().indexOf(n)){c=!0;break}c||(n=null)}}return null!==n},n.prototype.getHints=function(e){var t=this.editor.getModeForSelection(),i=this.editor.getCursorPos(),n="",r=[],s={queryStr:""},o=[];if("html"===t){var a=p.getTagInfo(this.editor,i),c=a.position.tokenType;if(c!==p.ATTR_VALUE||!l[a.attr.name])return null;a.position.offset>=0&&(s.queryStr=a.attr.value.slice(0,a.position.offset)),this.info=a}else{if(!(H.indexOf(t)>-1))return null;this.info=f.getInfoAtPos(this.editor,i);var d=this.info.context;if(d!==f.PROP_VALUE&&d!==f.IMPORT_URL)return null;if(-1!==this.info.index){var u,h="";for(u=0;u<this.info.index;u++)h+=this.info.values[u];this.info.index<this.info.values.length&&(h+=this.info.values[this.info.index].substr(0,this.info.offset)),h=h.replace(/^\s*url\(/i,"");var m=h.match(/^\s*/);m?(this.info.leadingWhitespace=m[0],h=h.substring(m[0].length)):this.info.leadingWhitespace=null,h.match(/^["']/)?(this.info.openingQuote=h[0],h=h.substring(1)):this.info.openingQuote=null,s.queryStr=h}}if(null!==s.queryStr&&(n=s.queryStr,r=this._getUrlHints(s)),this.info.filter=n,r instanceof Array&&r.length){var g=n.toLowerCase();return console.assert(!o.length),o=$.map(r,function(e){return 0===e.toLowerCase().indexOf(g)?e:void 0}),{hints:o,match:s.queryStr,selectInitial:!0,handleWideResults:!1}}if(r instanceof Object&&r.hasOwnProperty("done")){var v=$.Deferred();return r.done(function(e){var t=n.toLowerCase();o=$.map(e,function(e){return 0===e.toLowerCase().indexOf(t)?e:void 0}),v.resolveWith(this,[{hints:o,match:s.queryStr,selectInitial:!0,handleWideResults:!1}])}),v}return null},n.prototype.insertHint=function(e){function t(e){var t=i.editor.getModeForSelection();return e=encodeURI(e),"html"===t?i.insertHtmlHint(e):H.indexOf(t)>-1?i.insertCssHint(e):!1}var i=this;return e===w.label?(w.takeSelfie().done(function(e){e&&t(e),v.getActiveEditor().focus()}).fail(function(e){v.getActiveEditor().focus(),console.error("[Selfie error] ",e)}),!1):t(e)},n.prototype.getCharOffset=function(e,t,i){var n,r=0;if(t.index===i.index)return i.offset>=t.offset?i.offset-t.offset:0;if(t.index<i.index){if(t.index<0||t.index>=e.length||i.index<0||i.index>=e.length)return 0;for(n=t.index;n<=i.index;n++)r+=n===t.index?e[n].length-t.offset:n===i.index?i.offset:e[n].length}return r},n.prototype.findNextPosInArray=function(e,t,i){var n,r,s;for(n=i.index;n<e.length;n++)if(s=n===i.index?i.offset:0,r=e[n].indexOf(t,s),-1!==r)return{index:n,offset:r};return{index:-1,offset:-1}},n.prototype.insertCssHint=function(e){var t=this.editor.getCursorPos(),i={line:t.line,ch:t.ch},n={line:t.line,ch:t.ch},r=!1,s=!1,o=e,a=0,l={index:-1,offset:-1},c={index:-1,offset:-1};if(this.info.context!==f.PROP_VALUE&&this.info.context!==f.IMPORT_URL)return!1;if(this.closeOnSelect||null!==e.match(/\/$/)||(this.closeOnSelect=!0),this.info.openingQuote&&(l=this.findNextPosInArray(this.info.values,this.info.openingQuote,this.info),r=-1!==l.index),r?(c=this.findNextPosInArray(this.info.values,")",l),s=-1!==c.index):(l=this.findNextPosInArray(this.info.values,")",this.info),s=-1!==l.index),this.closeOnSelect)-1!==l.index&&(n.ch+=this.getCharOffset(this.info.values,this.info,l));else{var d=this.findNextPosInArray(this.info.values,"/",this.info);d.index===this.info.index&&d.offset===this.info.offset&&(n.ch+=1)}return this.info.filter.length>0&&(i.ch-=this.info.filter.length),this.info.openingQuote&&!r&&(o+=this.info.openingQuote),s||(this.info.leadingWhitespace&&(o+=this.info.leadingWhitespace),o+=")"),this.editor._codeMirror.replaceRange(o,i,n),this.closeOnSelect?(a=(r?1:0)+(s?1:0),a>0&&this.editor.setCursorPos(i.line,i.ch+e.length+a),!1):(a=(this.info.openingQuote&&!r?1:0)+(s?0:1),a>0&&this.editor.setCursorPos(i.line,i.ch+e.length),!0)},n.prototype.insertHtmlHint=function(e){var t=this.editor.getCursorPos(),i={line:-1,ch:-1},n={line:-1,ch:-1},r=p.getTagInfo(this.editor,t),s=r.position.tokenType,o=0,a="",l=!1;return s===p.ATTR_VALUE&&(this.closeOnSelect||null!==e.match(/\/$/)||(this.closeOnSelect=!0,l=!0),r.attr.hasEndQuote?e===r.attr.value&&(l=!1):(a=r.attr.quoteChar,a?e+=a:0===r.position.offset&&(e='"'+e+'"')),l?o=r.attr.value.length:(o=this.info.filter.length,this.info.attr.value.length>o&&"/"===this.info.attr.value[o]&&(o+=1))),n.line=i.line=t.line,i.ch=t.ch-r.position.offset,n.ch=i.ch+o,this.editor.document.replaceRange(e,i,n),this.closeOnSelect?(s===p.ATTR_VALUE&&r.attr.hasEndQuote&&this.editor.setCursorPos(i.line,i.ch+e.length+1),!1):(s!==p.ATTR_VALUE||r.attr.hasEndQuote||this.editor.setCursorPos(i.line,i.ch+e.length-1),!0)},c.appReady(function(){a=JSON.parse(S),l=a.htmlAttrs,o=new n,d.registerHintProvider(o,["css","html","less","scss"],100),u.on("change",s),u.on("rename",s)}),w.addSelfieCommand()});