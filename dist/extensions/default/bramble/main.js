define("lib/Tutorial",["require","exports","module","lib/PostMessageTransport"],function(e,t,n){"use strict";function r(e){u=!!e,u?(d=!0,h.reload()):p.close().done(p.open),b.triggerTutorialVisibilityChange(u)}function o(){return u}function a(){return v.join(f.project("root"),"tutorial.html")}function s(e){g.fs().stat(a(),function(t,n){e(n&&"FILE"===n.type)})}function i(){var e=m.getCurrentFullEditor();return e?a()===e.document.file.fullPath:!1}function l(){return d?(d=!1,!0):o()&&i()}function c(){return o()&&i()}var u,d,p=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),f=brackets.getModule("bramble/StartupState"),m=brackets.getModule("editor/EditorManager"),b=brackets.getModule("bramble/BrambleEvents"),g=brackets.getModule("filesystem/impls/filer/BracketsFiler"),v=g.Path,h=e("lib/PostMessageTransport");t.setOverride=r,t.getOverride=o,t.getPath=a,t.exists=s,t.shouldReload=l,t.shouldPostMessage=c}),define("lib/launcher",["require","exports","module","lib/Tutorial"],function(e,t,n){"use strict";function r(e){var t,n=e.browser,r=e.server;Object.defineProperty(this,"browser",{configurable:!1,get:function(){return n}}),Object.defineProperty(this,"server",{configurable:!1,get:function(){return r}}),Object.defineProperty(this,"tutorialOverride",{configurable:!1,get:function(){return t},set:function(e){t=e}}),a=this}function o(e,t){var n=a.server,r=a.browser;t=t||function(){},n.serveLiveDocForUrl(e,function(e,n){return e?(console.error("[Launcher Error]",e),t()):(r.update(n),void t())})}var a,s=e("lib/Tutorial");r.prototype.launch=function(e,t){return s.getOverride()?void s.exists(function(e){e?s.shouldReload()&&o(s.getPath(),t):(console.error("[Launcher Error] expected tutorial.html to exist"),s.setOverride(!1))}):o(e,t)},r.getCurrentInstance=function(){return a},n.exports=r}),define("text",["module"],function(e){"use strict";var t,n,r,o,a,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,u=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,p=c&&(location.port||void 0),f={},m=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,o=!1,a=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==a&&(!s||a>1)?(t=e.substring(0,a),n=e.substring(a+1,e.length)):t=e,r=n||t,a=r.indexOf("!"),-1!==a&&(o="strip"===r.substring(a+1),r=r.substring(0,a),n?n=r:t=r),{moduleName:t,ext:n,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,o){var a,s,i,l=t.xdRegExp.exec(e);return l?(a=l[2],s=l[3],s=s.split(":"),i=s[1],s=s[0],!(a&&a!==n||s&&s.toLowerCase()!==r.toLowerCase()||(i||s)&&i!==o)):!0},finishLoad:function(e,n,r,o){r=n?t.strip(r):r,m.isBuild&&(f[e]=r),o(r)},load:function(e,n,r,o){if(o.isBuild&&!o.inlineText)return void r();m.isBuild=o.isBuild;var a=t.parseName(e),s=a.moduleName+(a.ext?"."+a.ext:""),i=n.toUrl(s),l=m.useXhr||t.useXhr;return 0===i.indexOf("empty:")?void r():void(!c||l(i,u,d,p)?t.get(i,function(n){t.finishLoad(e,a.strip,n,r)},function(e){r.error&&r.error(e)}):n([s],function(e){t.finishLoad(a.moduleName+"."+a.ext,a.strip,e,r)}))},write:function(e,n,r,o){if(f.hasOwnProperty(n)){var a=t.jsEscape(f[n]);r.asModule(e+"!"+n,"define(function () { return '"+a+"';});\n")}},writeFile:function(e,n,r,o,a){var s=t.parseName(n),i=s.ext?"."+s.ext:"",l=s.moduleName+i,c=r.toUrl(s.moduleName+i)+".js";t.load(l,r,function(n){var r=function(e){return o(c,e)};r.asModule=function(e,t){return o.asModule(e,c,t)},t.write(e,l,r,a)},a)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var o=n.readFileSync(e,"utf8");0===o.indexOf("\ufeff")&&(o=o.substring(1)),t(o)}catch(a){r(a)}}):"xhr"===m.env||!m.env&&t.createXhr()?t.get=function(e,n,r,o){var a,s=t.createXhr();if(s.open("GET",e,!0),o)for(a in o)o.hasOwnProperty(a)&&s.setRequestHeader(a.toLowerCase(),o[a]);m.onXhr&&m.onXhr(s,e),s.onreadystatechange=function(t){var o,a;4===s.readyState&&(o=s.status,o>399&&600>o?(a=new Error(e+" HTTP status: "+o),a.xhr=s,r(a)):n(s.responseText),m.onXhrComplete&&m.onXhrComplete(s,e))},s.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,r,o="utf-8",a=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),i=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),o)),l="";try{for(n=new java.lang.StringBuffer,r=i.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&n.append(r);null!==(r=i.readLine());)n.append(s),n.append(r);l=String(n.toString())}finally{i.close()}t(l)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,o=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,s,i,l={};a&&(e=e.replace(/\//g,"\\")),i=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),n.init(i,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),s.init(n,"utf-8",n.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),l),s.close(),n.close(),t(l.value)}catch(c){throw new Error((i&&i.path||"")+": "+c)}}),t}),define("text!lib/PostMessageTransportRemote.js",[],function(){return'// This is a transport injected into the browser via a script that handles the low\n// level communication between the live development protocol handlers on both sides.\n// This transport provides a postMessage mechanism. It\'s injected separately from the\n// protocol handler so that the transport can be changed separately.\n\n(function (global) {\n    "use strict";\n    // In case of detached preview window.opener will refer to editor window\n    var parent = window.opener || window.parent;\n    var postMessageTransport = {\n        /**\n         * @private\n         * An object that contains callbacks to handle various transport events. See `setCallbacks()`.\n         * @type {?{connect: ?function, message: ?function(string), close: ?function}}\n         */\n        _callbacks: null,\n\n        /**\n         * Sets the callbacks that should be called when various transport events occur.\n         */\n        setCallbacks: function (callbacks) {\n            this._callbacks = callbacks;\n        },\n\n        connect: function (url) {\n            var self = this;\n\n            parent.postMessage(JSON.stringify({\n                type: "connect",\n                url: global.location.href\n            }), "*");\n\n            if (self._callbacks && self._callbacks.connect) {\n                self._callbacks.connect();\n            }\n        },\n\n        /**\n         * Sends a message over the transport.\n         * @param {string} msgStr The message to send.\n         * @param {string} data The data object to be shown in console\n         */\n        send: function (msgStr, data) {\n            parent.postMessage(JSON.stringify({\n                type: "message",\n                message: msgStr,\n                data: data\n            }), "*");\n        },\n\n        /**\n         * Establish postMessage connection.\n         */\n        enable: function () {\n            this.connect();\n            var self = this;\n\n            // Listen for message.\n            window.addEventListener("message", function (event) {\n                if (self._callbacks && self._callbacks.message) {\n                    self._callbacks.message(event.data);\n                }\n            });\n        }\n    };\n\n    global._Brackets_LiveDev_Transport = postMessageTransport;\n}(this));\n'}),define("text!lib/MouseManagerRemote.js",[],function(){return'/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true, bitwise: true */\n/* global addEventListener, removeEventListener, sessionStorage */\n(function(transport) {\n    "use strict";\n\n    var SCROLL_KEY = "___bramble-preview-scrollTop::" + window.___brambleFilename;\n\n    var listening = false;\n\n    function sendHighlightInfo(e) {\n        var x = e.pageX - window.pageXOffset;\n        var y = e.pageY - window.pageYOffset;\n        var elem = document.elementFromPoint(x, y);\n        if(!elem) {\n            return;\n        }\n\n        var ds = elem.dataset;\n        if(!(ds.brambleStartLine && ds.brambleStartCh && ds.brambleEndLine && ds.brambleEndCh)) {\n            return;\n        }\n\n        // If the element has a brackets-id, and this was a click,\n        // use that info to highlight it. Don\'t bother for mousemove.\n        var bracketsId = ds.bracketsId;\n        if(bracketsId) {\n            bracketsId = "," + bracketsId;\n        }\n\n        transport.send("bramble-highlight-lines:" + ds.brambleStartLine + "," +\n            ds.brambleStartCh + "," + ds.brambleEndLine + "," + ds.brambleEndCh + bracketsId);\n    }\n\n    function shouldIgnoreElemEvent(e) {\n        // Ignore mouseout for any inner elements (just for entire window)\n        var from = e.relatedTarget || e.toElement;\n        if(!from || from.nodeName === "HTML") {\n            // Further filter things by only responding to events close to the left/top\n            if(e.clientX <= 32 || e.clientY <= 32) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function startListener() {\n        if(listening) {\n            return;\n        }\n\n        addEventListener("mousemove", sendHighlightInfo, false);\n        listening = true;\n    }\n\n    function stopListener() {\n        if(!listening) {\n            return;\n        }\n\n        removeEventListener("mousemove", sendHighlightInfo, false);\n        listening = false;\n    }\n\n    addEventListener("DOMContentLoaded", function() {\n        // Restore last scroll position for this session (if any)\n        document.body.scrollTop = sessionStorage.getItem(SCROLL_KEY)|0;\n\n        // Do not listen for mouse events relevant for the inspector\n        // if there is no livedoc\n        if(!transport) {\n            return;\n        }\n\n        startListener();\n\n        // If the user clicks on an element, stop inspecting with mousemove (pin editor)\n        addEventListener("click", function(e) {\n            transport.send("bramble-inspector-disable");\n            stopListener();\n            sendHighlightInfo(e);\n        });\n\n        addEventListener("mouseout", function(e) {\n            if(!shouldIgnoreElemEvent(e)) {\n                // Start listening for user inspecting elements (again)\n                startListener();\n                return false;\n            }\n        });\n\n    }, false);\n\n    // Remember last scroll position for this document\n    addEventListener("scroll", function() {\n        sessionStorage.setItem(SCROLL_KEY, document.body.scrollTop);\n    }, false);\n\n}(window._Brackets_LiveDev_Transport));\n'}),define("lib/MouseManager",["require","exports","module","text!lib/MouseManagerRemote.js","lib/iframe-browser"],function(e,t,n){"use strict";function r(e){var t,n;t=R.getBrowserIframe(),t&&(n=t.contentDocument||t.contentWindow.document,n&&(n.body.style.cursor=e))}function o(){r(x?"pointer":"auto")}function a(){var e=_._getCurrentLiveDoc(),t=e.doc.file.fullPath,n=y.getActiveEditor(),r=n.document.file.fullPath;t!==r&&T.resolve(t,function(e,n){return e?void console.log("[Bramble Error] unable to open path in editor",t,e):void E.execute(S.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:n.fullPath})})}function s(){var e=y.getActiveEditor();return e._codeMirror}function i(){var e=s();g();var t=e.getDoc(),n=t.getCursor("start");e.setCursor(n)}function l(){function e(){var t=s();t.off("focus",e),i()}var t=s();t.on("focus",e)}function c(){x=!0,a(),l(),i(),p(),r("pointer"),L.triggerInspectorChange(!0)}function u(e){x=!1,r("auto"),e?(p(),i()):w=null,L.triggerInspectorChange(!1)}function d(e){if(e!==w){w=e;var t="[data-brackets-id='"+e+"']",n="_LD.highlightRule("+JSON.stringify(t)+")";k.evaluate(n)}}function p(){w=null,k.evaluate("_LD.hideHighlight()")}function f(e){var t=e.match(/^bramble-highlight-lines\:([0-9]+),([0-9]+),([0-9]+),([0-9]+),?([0-9]+)?/);if(t&&t[1]&&t[2]&&t[3]&&t[4])return{startLine:0|t[1],startCh:0|t[2],endLine:0|t[3],endCh:0|t[4],bracketsId:0|t[5]}}function m(e){return!!f(e)}function b(e){return e.match(/^bramble-inspector-disable$/)}function g(){M&&(M.clear(),M=null)}function v(e){if(x){var t=f(e);if(t){var n={line:t.startLine,ch:t.startCh},r={line:t.endLine,ch:t.endCh};g(),t.bracketsId&&d(t.bracketsId);var o=s(),a=o.getScrollInfo().clientHeight/2|0;o.scrollIntoView({from:n,to:r},a),M=o.markText(n,r,{className:"bramble-inspector-highlight"})}}}function h(e){return e=e||"unknown","<script>window.___brambleFilename = '"+e+"';</script>\n<script>\n"+B+"</script>\n"}var M,w,L=brackets.getModule("bramble/BrambleEvents"),y=brackets.getModule("editor/EditorManager"),_=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),k=brackets.getModule("LiveDevelopment/MultiBrowserImpl/protocol/LiveDevProtocol"),E=brackets.getModule("command/CommandManager"),S=brackets.getModule("command/Commands"),T=brackets.getModule("filesystem/FileSystem"),B=e("text!lib/MouseManagerRemote.js"),R=e("lib/iframe-browser"),x=!1;t.enableInspector=c,t.disableInspector=u,t.isDisableRequest=b,t.getRemoteScript=h,t.highlightLine=v,t.isHighlightLineRequest=m,t.ensurePreviewCursor=o}),define("text!lib/LinkManagerRemote.js",[],function(){return'/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true, bitwise: true */\n/* global addEventListener, window */\n(function() {\n    "use strict";\n\n    function handleClick(e) {\n        var anchor = e.currentTarget;\n        var url = anchor.getAttribute("href");\n        var element;\n\n        // For local paths vs. absolute URLs, try to open the right file.\n        // Special case (i.e., pass through) some common, non-http(s) protocol\n        // schemes so they work as expected.\n        if(/^(javascript|mailto|data|blob):/.test(url)) {\n            return true;\n        }\n\n        var pathNav = !(/\\:?\\/\\//.test(url));\n        // `fragmentId` handles the special case of fragment ids in the\n        // same html page in preview mode (not tutorial mode)\n        var fragmentId = /^\\s*#/.test(url);\n\n        if(fragmentId) {\n            element = document.querySelector(url) || document.getElementsByName(url.slice(1));\n            if(element) {\n                element = element[0] || element;\n                element.scrollIntoView(true);\n            }\n        } else if(pathNav && window._Brackets_LiveDev_Transport) {\n            window._Brackets_LiveDev_Transport.send("bramble-navigate:" + url);\n        } else {\n            window.open(url, "_blank");\n        }\n\n        return false;\n    }\n\n    addEventListener("DOMContentLoaded", function init() {\n        // Intercept clicks to <a> in the document.\n        var links = document.links;\n        var len = links.length;\n\n        for(var i=0; i<len; i++) {\n            links[i].onclick = handleClick;\n        }\n    }, false);\n}());\n'}),define("lib/LinkManager",["require","exports","module","text!lib/LinkManagerRemote.js"],function(e,t,n){"use strict";function r(){return"<script>\n"+p+"</script>\n"}function o(e){var t=e.match(/^bramble-navigate\:(.+)/);return t&&t[1]}function a(e){return!!o(e)}function s(e){var t=o(e);if(t){var n=i._getCurrentLiveDoc();if(n){var r=l.dirname(n.doc.file.fullPath);t=l.resolve(r,t),d.resolve(t,function(e,n){return e?void console.log("[Bramble Error] unable to open path in editor",t,e):void c.execute(u.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:n.fullPath})})}}}var i=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),l=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,c=brackets.getModule("command/CommandManager"),u=brackets.getModule("command/Commands"),d=brackets.getModule("filesystem/FileSystem"),p=e("text!lib/LinkManagerRemote.js");t.getRemoteScript=r,t.isNavigationRequest=a,t.navigate=s}),define("text!lib/ConsoleManagerRemote.js",[],function(){return'(function(transport, console) {\n    "use strict";\n    \n    function transportSend(type, args) {  \n        var data = {args: args, type: type};\n        transport.send("bramble-console", data);\n    }\n    \n    // Implement standard console.* functions\n    ["log",\n     "warn",\n     "info",\n     "debug",\n     "info",\n     "error",\n     "clear",\n     "time",\n     "timeEnd"].forEach(function(type) {\n        console[type] = function() {\n            var args = Array.from(arguments).slice();\n            transportSend(type, args);\n        };\n    });\n    \n    console.assert = function() {\n        var args = Array.from(arguments).slice();\n        var expr = args.shift();\n        if (!expr) {\n            args[0] = "Assertion Failed: " + args[0];\n            transportSend(args, "error");\n        }\n    };\n}(window._Brackets_LiveDev_Transport, window.console));\n'}),define("lib/ConsoleManager",["require","exports","module","text!lib/ConsoleManagerRemote.js"],function(e,t,n){"use strict";function r(){return"<script>\n"+s+"</script>\n"}function o(e){return e.match(/^bramble-console/)}function a(e){var t=e.args,n=e.type||"log";console[n].apply(console,t)}var s=e("text!lib/ConsoleManagerRemote.js");t.getRemoteScript=r,t.isConsoleRequest=o,t.handleConsoleRequest=a}),define("text!lib/xhr/XHRShim.js",[],function(){return'/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true */\n/* global DOMParser */\n(function(global) {\n    "use strict";\n\n    // This script requires access to the transport to send\n    // file requests to the editor as commands\n    var transport = global._Brackets_LiveDev_Transport;\n\n    var XMLHttpRequest = global.XMLHttpRequest;\n    if(!XMLHttpRequest) {\n        console.error("[Brackets LiveDev] XMLHttpRequest not supported in preview");\n        return;\n    }\n\n    function sendMessage(msg) {\n        if(!transport) {\n            console.error("[Brackets LiveDev] No transport set");\n            return;\n        }\n\n        transport.send(JSON.stringify(msg));\n    }\n\n    function nativeXHRFn(xhr, condition, fn, args) {\n        if(condition) {\n            return fn.apply(xhr, args) || true;\n        }\n\n        return null;\n    }\n\n    function XMLHttpRequestLiveDev() {\n        var xhr = new XMLHttpRequest();\n        // Internally store properties normally attached to XHR\n        var _requestUrl;\n        var _abortCalled = false;\n        var _readyState = 0;\n        var _status = 0;\n        var _statusText = "";\n        var _response = "";\n        var _responseText = "";\n        var _responseType;\n        var _onreadystatechange;\n        var _onerror;\n        var _onload;\n        var self = this;\n\n        var $open = xhr.open;\n        // The async parameter for XHRs to the local file system\n        // is ignored as we cannot support synchronous requests\n        // and async is implicit\n        self.open = function(method, url, async, user, password) {\n            if(!(/\\:?\\/\\//.test(url) || /\\s*data\\:/.test(url))) {\n                _requestUrl = url;\n                _abortCalled = false;\n            } else {\n                $open.apply(xhr, arguments);\n            }\n        };\n\n        var $send = xhr.send;\n        self.send = function() {\n            if(!_requestUrl) {\n                $send.apply(xhr, arguments);\n                return;\n            }\n\n            function handleError(data) {\n                _status = data.status || 500;\n                _statusText = data.error || "Internal Server Error";\n                _readyState = 4;\n                data.error = data.error || data;\n\n                if(typeof _onreadystatechange === "function" && !_abortCalled) {\n                    _onreadystatechange.call(self);\n                }\n\n                if(typeof _onerror === "function" && !_abortCalled) {\n                    return _onerror.call(self, {error: data.error});\n                }\n            }\n\n            function setResponse(data) {\n                if(data.error && !_abortCalled) {\n                    return handleError(data);\n                }\n\n                _readyState = 4;\n                _status = 200;\n                _statusText = "OK";\n\n                if(!_responseType || _responseType === "") {\n                    _responseType = "text";\n                }\n\n                switch(_responseType) {\n                case "text":\n                    _response = data.content;\n                    _responseText = _response;\n                    break;\n                case "document":\n                    _response = new DOMParser(data.content, data.mimeType);\n                    _responseText = data.content;\n                    break;\n                case "json":\n                    try {\n                        _response = JSON.parse(data.content);\n                        _responseText = data.content;\n                    } catch(e) {\n                        handleError(e);\n                        return;\n                    }\n                    break;\n                default:\n                    // TODO: We should support arraybuffers and blobs\n                    handleError("Response type of " + _responseType + " is not supported. Response type must be `text`, `document` or `json`.");\n                    return;\n                }\n\n                if(typeof _onreadystatechange === "function" && !_abortCalled) {\n                    _onreadystatechange.call(self);\n                }\n                if(typeof _onload === "function" && !_abortCalled) {\n                    // TODO: deal with addEventListener\n                    _onload.call(self);\n                }\n            }\n\n            window.addEventListener("message", function(event) {\n                var data = event.data;\n\n                try {\n                    data = JSON.parse(data);\n                } catch(e) {\n                    return;\n                }\n\n                if(data.method === "XMLHttpRequest") {\n                    setResponse(data);\n                }\n            });\n\n            sendMessage({\n                method: "XMLHttpRequest",\n                path: _requestUrl\n            });\n\n            _readyState = 1;\n        };\n\n        self.abort = function() {\n            if(!nativeXHRFn(xhr, !_requestUrl, xhr.abort, arguments)) {\n                _abortCalled = true;\n            }\n        };\n\n        self.setRequestHeader = function() {\n            nativeXHRFn(xhr, !_requestUrl, xhr.setRequestHeader, arguments);\n        };\n\n        self.getAllResponseHeaders = function() {\n            return nativeXHRFn(xhr, !_requestUrl, xhr.getAllResponseHeaders, arguments);\n        };\n\n        self.getResponseHeader = function() {\n            return nativeXHRFn(xhr, !_requestUrl, xhr.getResponseHeader, arguments);\n        };\n\n        self.overrideMimeType = function() {\n            nativeXHRFn(xhr, !_requestUrl, xhr.overrideMimeType, arguments);\n        };\n\n        // Expose the properties on the XHR object depending on whether\n        // it is using native XHR or our postmessage XHR\n        Object.defineProperties(self, {\n            "onreadystatechange": {\n                get: function() { return _requestUrl ? _onreadystatechange : xhr.onreadystatechange; },\n                set: function(fn) {\n                    _onreadystatechange = xhr.onreadystatechange = fn;\n                }\n            },\n            "onload": {\n                get: function() { return _requestUrl ? _onload : xhr.onload; },\n                set: function(fn) { _onload = xhr.onload = fn; }\n            },\n            "onerror": {\n                get: function() { return _requestUrl ? _onerror : xhr.onerror; },\n                set: function(fn) { _onerror = xhr.onerror = fn; }\n            },\n            "readyState": {\n                get: function() { return _requestUrl ? _readyState : xhr.readyState; }\n            },\n            "response": {\n                get: function() { return _requestUrl ? _response : xhr.response; }\n            },\n            "responseText": {\n                get: function() { return _requestUrl ? _responseText : xhr.responseText; }\n            },\n            "responseType": {\n                get: function() { return _requestUrl ? _responseType : xhr.responseType; },\n                set: function(value) {\n                    _responseType = xhr.responseType = value;\n                }\n            },\n            "responseXML": {\n                get: function() { return _requestUrl ? null : xhr.responseXML; }\n            },\n            "status": {\n                get: function() { return _requestUrl ? _status : xhr.status; }\n            },\n            "statusText": {\n                get: function() { return _requestUrl ? _statusText : xhr.statusText; }\n            },\n            "timeout": {\n                get: function() { return _requestUrl ? null : xhr.timeout; },\n                set: function(value) {\n                    if(!_requestUrl) { xhr.timeout = value; }\n                }\n            },\n            "ontimeout": {\n                get: function() { return _requestUrl ? null : xhr.ontimeout; },\n                set: function(fn) {\n                    if(!_requestUrl) { xhr.ontimeout = fn; }\n                }\n            },\n            "upload": {\n                get: function() { return _requestUrl ? null : xhr.upload; }\n            },\n            "withCredentials": {\n                get: function() { return _requestUrl ? null : xhr.withCredentials; },\n                set: function(value) {\n                    if(!_requestUrl) { xhr.withCredentials = value; }\n                }\n            }\n        });\n    }\n\n    global.XMLHttpRequest = XMLHttpRequestLiveDev;\n\n}(this));\n'}),define("lib/PostMessageTransport",["require","exports","module","lib/launcher","lib/iframe-browser","text!lib/PostMessageTransportRemote.js","lib/Tutorial","lib/MouseManager","lib/LinkManager","lib/ConsoleManager","text!lib/xhr/XHRShim.js"],function(e,t,n){"use strict";function r(e){e&&(f=e)}function o(e){var t=new RegExp('\\"(blob:[^"]+)\\"',"gm"),n=e.replace(t,function(e,t){var n=M.getFilename(t);return['"',n,'"'].join("")});return n}function a(e){var t;try{t=JSON.parse(e.data)}catch(r){return}if("message"===t.type){if(S.isNavigationRequest(t.message))return void S.navigate(t.message);if(E.isHighlightLineRequest(t.message))return void E.highlightLine(t.message);if(E.isDisableRequest(t.message))return void E.disableInspector();if(t.message&&(t.message=o(t.message)),T.isConsoleRequest(t.message))return void T.handleConsoleRequest(t.data);n.exports.trigger("message",[m,t.message])}else"connect"===t.type&&(g.setListener(),E.ensurePreviewCursor())}function s(){window.addEventListener("message",a);var e=y.ui("autoUpdate");"boolean"==typeof e&&d(e),w.on("fileRemoved",p),w.on("fileRenamed",p)}function i(e){var t=h._getCurrentLiveDoc();if(!t)return e;var n=L.dirname(t.doc.file.fullPath),r=new RegExp('(\\\\?\\"?)(href|src|url|value)(\\\\?\\"?\\s?:?\\s?\\(?\\\\?\\"?)([^\\\\"\\),]+)(\\\\?\\"?)',"gm"),o=e.replace(r,function(e,t,r,o,a,s){var i="/"===a.charAt(0)?a:L.join(n,a),l=M.getUrl(i);return a=l===i?a:l,[t,r,o,a,s].join("")});return o}function l(e,t){var n=f.contentWindow;t=i(t);var r=JSON.parse(t),o=g.getDetachedPreview();return"Page.reload"===r.method?void p():"Page.navigate"===r.method?void p(!0):(n.postMessage(t,"*"),void(o&&k.shouldPostMessage()&&o.postMessage(t,"*")))}function c(e){window.removeEventListener("message",a)}function u(e){var t=h._getCurrentLiveDoc(),n=e||t&&t.doc.file.fullPath;return'<base href="'+window.location.href+'">\n<script>\n'+_+"</script>\n<script>\n"+B+"</script>\n"+E.getRemoteScript(n)+S.getRemoteScript()+T.getRemoteScript()}function d(e){x=e,x&&p(!0)}function p(e){var t,n=b.getCurrentInstance(),r=h._getCurrentLiveDoc();(x||e)&&r&&(t=M.getUrl(r.doc.file.fullPath),R!==t&&(R=t,n.launch(t,function(){R=null})))}var f,m=1,b=e("lib/launcher"),g=e("lib/iframe-browser"),v=brackets.getModule("utils/EventDispatcher"),h=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),M=brackets.getModule("filesystem/impls/filer/BlobUtils"),w=brackets.getModule("bramble/BrambleEvents"),L=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,y=brackets.getModule("bramble/StartupState"),_=e("text!lib/PostMessageTransportRemote.js"),k=e("lib/Tutorial"),E=e("lib/MouseManager"),S=e("lib/LinkManager"),T=e("lib/ConsoleManager"),B=e("text!lib/xhr/XHRShim.js");v.makeEventDispatcher(n.exports);var R,x=!0;n.exports.getRemoteScript=u,n.exports.setAutoUpdate=d,n.exports.setIframe=r,n.exports.start=s,n.exports.send=l,n.exports.close=c,n.exports.reload=p}),define("lib/compatibility",["require","exports","module"],function(e,t,n){"use strict";var r;t.supportsIFrameHTMLBlobURL=function(e){function t(){clearTimeout(s);try{r=!!a.contentWindow.document.querySelector("#bloburl-test"),document.body.removeChild(a),a=null,URL.revokeObjectURL(o),n=null,o=null}catch(t){r=!1}e(null,r)}if("undefined"!=typeof r)return void e(null,r);var n=new Blob(["<div id='bloburl-test'></div>"],{type:"text/html"}),o=URL.createObjectURL(n),a=document.createElement("iframe");a.style.display="none",document.body.appendChild(a);var s;a.onload=t,a.src=o,s=setTimeout(t,1e3)}}),define("lib/iframe-browser",["require","exports","module","lib/PostMessageTransport","lib/compatibility"],function(e,t,n){"use strict";function r(){if(!i()){var e=b.getLayoutScheme();1===e.rows&&1===e.columns&&a(L);var t=$("#second-pane").empty(),n={id:"bramble-iframe-browser",frameborder:0};$("<iframe>",n).addClass("iframeWidthHeight").appendTo(t)}}function o(e){e===M?L=M:e===w&&(L=w)}function a(){L===M?m.execute(g.CMD_SPLITVIEW_VERTICAL):L===w&&m.execute(g.CMD_SPLITVIEW_HORIZONTAL),b.setActivePaneId("first-pane")}function s(e){if(e){var t,n=i();_.supportsIFrameHTMLBlobURL(function(r,o){if(r)return void console.error("[Brackets IFrame-Browser] Unexpected error:",r);n&&(o?n.src=e:(t=n.contentWindow.document.open("text/html","replace"),t.write(e),t.close()));var a=c();a&&(f=!0,o?a.location.replace(e):(t=a.document.open("text/html","replace"),t.write(e),t.close()))})}}function i(){return window.document.getElementById("bramble-iframe-browser")}function l(){var e=i();if(e){y.reload();var t=e.src;return p=window.open(t,"Preview"),_.supportsIFrameHTMLBlobURL(function(t,n){if(t)return void console.error("[Brackets IFrame-Browser] Unexpected error:",t);if(!n){var r=p.document.open("text/html","replace");r.write(e.contentWindow.document.documentElement.outerHTML),r.close()}return v.hide("#second-pane"),$("#first-pane").addClass("expandEditor"),$("#liveDevButton").removeClass("liveDevButtonDetach"),$("#liveDevButton").addClass("liveDevButtonAttach"),h.addIndicator("liveDevButtonBox",$("#liveDevButtonBox"),!0,"","Click to return preview to current window","mobileViewButtonBox"),
p})}}function c(){return p&&!p.closed?p:void 0}function u(){var e=c();return e&&f?void(f=!1):(e&&(e.removeEventListener("beforeunload",u,!1),e.close()),v.show("#second-pane"),$("#liveDevButton").removeClass("liveDevButtonAttach"),$("#liveDevButton").addClass("liveDevButtonDetach"),$("#first-pane").removeClass("expandEditor"),void h.addIndicator("liveDevButtonBox",$("#liveDevButtonBox"),!0,"","Click to open preview in separate window","mobileViewButtonBox"))}function d(){var e=c();e&&e.addEventListener("beforeunload",u,!1)}var p,f,m=brackets.getModule("command/CommandManager"),b=brackets.getModule("view/MainViewManager"),g=brackets.getModule("command/Commands"),v=brackets.getModule("utils/Resizer"),h=brackets.getModule("widgets/StatusBar"),M=0,w=1,L=M,y=e("lib/PostMessageTransport"),_=e("lib/compatibility");t.init=r,t.update=s,t.show=a,t.getBrowserIframe=i,t.HORIZONTAL_ORIENTATION=w,t.VERTICAL_ORIENTATION=M,t.setOrientation=o,t.getDetachedPreview=c,t.attachPreview=u,t.detachPreview=l,t.setListener=d}),define("text!lib/Mobile.html",[],function(){return'<div class="phone-wrapper">\n  <div class="phone-container">\n      <div class="phone-inner">\n          <div class="phone-top"></div>\n          <div id="phone-content" class="phone-border">\n          </div>\n          <div class="phone-shadow"></div>\n          <div class="phone-bottom"></div>\n      </div>\n  </div>\n<div>'}),define("lib/Theme",["require","exports","module"],function(e,t,n){"use strict";function r(e){var t=e.theme||a();o("light-theme"===t?"dark-theme":"light-theme")}function o(e){l.set("theme",e),f.triggerThemeChange(e)}function a(){return l.get("theme")}function s(e){var t={name:"main.less",_path:c.join(p,"lightTheme.css")},n={name:"light-theme"},r={name:"main.less",_path:c.join(p,"darkTheme.css")},o={name:"dark-theme",theme:{dark:!0}};i.addTheme(t,n),i.addTheme(r,o),"light-theme"!==e&&"dark-theme"!==e&&(e="dark-theme"),l.set("theme",e)}var i=brackets.getModule("view/ThemeManager"),l=brackets.getModule("preferences/PreferencesManager").getExtensionPrefs("themes"),c=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,u=brackets.getModule("thirdparty/path-utils/path-utils"),d=u.directory(window.location.href),p=c.join(d,"extensions/default/bramble/stylesheets"),f=brackets.getModule("bramble/BrambleEvents");n.exports.toggle=r,n.exports.setTheme=o,n.exports.getTheme=a,n.exports.init=s}),define("lib/UI",["require","exports","module","text!lib/Mobile.html","lib/PostMessageTransport","lib/iframe-browser","lib/compatibility","lib/Theme"],function(e,t,n){"use strict";function r(e){v(function(){g();var t=S.project("root");T.getDirectoryForPath(t).getContents(function(t,n){a()&&(l(),c(),i(),u(),s(),n&&1===n.length&&R.hide()),o(),$("#spinner-container").remove(),$("#main-view").css("visibility","visible"),e()})})}function o(){O.init(S.ui("theme"));var e=S.ui("previewMode");if(e)switch(e){case"desktop":m(!0);break;case"mobile":b(!0);break;default:console.warn("[Bramble] unknown preview mode: `"+e+"`")}var t=S.ui("wordWrap");"boolean"==typeof t&&C.set("wordWrap",t);var n=S.ui("autoCloseTags")||{whenOpening:!0,whenClosing:!0,indentTags:[]};C.set("closeTags",n);var r=S.ui("openSVGasXML");"boolean"==typeof r&&C.set("openSVGasXML",r);var o=S.ui("allowJavaScript");"boolean"==typeof o&&C.set("allowJavaScript",o);var a=S.ui("allowAutocomplete");"boolean"==typeof a&&(C.set("codehint.AttrHints",a),C.set("codehint.TagHints",a),C.set("codehint.JSHints",a),C.set("codehint.CssPropHints",a));var s=S.ui("autoUpdate");"boolean"==typeof s&&C.set("autoUpdate",s);var i=S.ui("sidebarWidth");i&&R.resize(i);var l=S.ui("sidebarVisible");null!==l&&(l?R.show():R.hide());var c=S.ui("secondPaneWidth"),u=S.ui("firstPaneWidth");u=100*u/((u?u:0)+(c?c:0)),u&&$("#first-pane").width(u+"%");var d=S.ui("fontSize");d&&/\d+px/.test(d)&&B.setFontSize(d),x.recomputeLayout(!0)}function a(){var e=new L;return e.parse(),"1"!==e.get("ui")}function s(){y.disable()}function i(){$("#working-set-list-second-pane").addClass("hideLeftToolbar"),$("#sidebar .working-set-splitview-btn").remove()}function l(){$("#titlebar").remove(),$("#first-pane .pane-header").remove(),$("#editor-holder").addClass("editor-holder-height"),$("#first-pane .pane-content, .cm-s-light-theme").addClass("first-pane-height")}function c(){M.removeMenu(M.AppMenuBar.FILE_MENU),M.removeMenu(M.AppMenuBar.EDIT_MENU),M.removeMenu(M.AppMenuBar.FIND_MENU),M.removeMenu(M.AppMenuBar.VIEW_MENU),M.removeMenu(M.AppMenuBar.NAVIGATE_MENU),M.removeMenu(M.AppMenuBar.HELP_MENU)}function u(){w.makeResizable("#main-toolbar"),w.hide("#main-toolbar"),$(".content").addClass("hideRightToolbar")}function d(e){e.preventDefault(),k.setActivePaneId("first-pane")}function p(){$("#main-view").addClass("fullscreen-preview")}function f(){$("#main-view").removeClass("fullscreen-preview"),k.setActivePaneId("first-pane")}function m(e){H&&($("#mobileViewButton").removeClass("desktopButton"),$("#mobileViewButton").addClass("mobileButton"),y.updateIndicator("mobileViewButtonBox",!0,"","Click to open preview in a mobile view"),$("#bramble-iframe-browser").appendTo("#second-pane"),$(".phone-wrapper").detach(),$("#second-pane").removeClass("second-pane-scroll"),$("#second-pane").off("click",d),H=!1,E.triggerPreviewModeChange("desktop"),e||D.reload())}function b(e){H||($("#mobileViewButton").removeClass("mobileButton"),$("#mobileViewButton").addClass("desktopButton"),y.updateIndicator("mobileViewButtonBox",!0,"","Click to open preview in a desktop view"),$("#bramble-iframe-browser").addClass("phone-body"),$("#second-pane").append(I),$("#bramble-iframe-browser").appendTo("#phone-content"),$("#second-pane").addClass("second-pane-scroll"),$("#second-pane").on("click",d),H=!0,E.triggerPreviewModeChange("mobile"),e||D.reload())}function g(){var e=P.render("<div><a id='mobileViewButton' href=#></a></div>",_);y.addIndicator("mobileViewButtonBox",$(e),!0,"","Click to open preview in a mobile view","status-overwrite"),$("#mobileViewButton").addClass("mobileButton"),$("#mobileViewButton").click(function(){H?m():b()})}function v(e){var t=P.render("<div><a id='liveDevButton' href=#></a></div>",_);y.addIndicator("liveDevButtonBox",$(t),!0,"","Click to open preview in separate window","mobileViewButtonBox"),$("#liveDevButton").addClass("liveDevButtonDetach"),$("#liveDevButton").click(function(){w.makeResizable("#second-pane"),w.isVisible("#second-pane")?A.detachPreview():A.attachPreview()}),U.supportsIFrameHTMLBlobURL(function(t,n){return t?(console.error("[Brackets IFrame-Browser] Unexpected error:",t),e()):(!n&&document.all&&($("#liveDevButton").css("display","none"),console.log("[Brackets IFrame-Browser] Detachable preview disabled due to incompatibility with current browser (you are possibly running IE 10 or below)")),void e())})}function h(){return H?"mobile":"desktop"}var M=brackets.getModule("command/Menus"),w=brackets.getModule("utils/Resizer"),L=brackets.getModule("utils/UrlParams").UrlParams,y=brackets.getModule("widgets/StatusBar"),_=brackets.getModule("strings"),k=brackets.getModule("view/MainViewManager"),E=brackets.getModule("bramble/BrambleEvents"),S=brackets.getModule("bramble/StartupState"),T=brackets.getModule("filesystem/FileSystem"),B=brackets.getModule("view/ViewCommandHandlers"),R=brackets.getModule("project/SidebarView"),x=brackets.getModule("view/WorkspaceManager"),C=brackets.getModule("preferences/PreferencesManager"),P=brackets.getModule("thirdparty/mustache/mustache"),I=e("text!lib/Mobile.html"),D=e("lib/PostMessageTransport"),A=e("lib/iframe-browser"),U=e("lib/compatibility"),O=e("lib/Theme"),H=!1;t.initUI=r,t.showMobileView=b,t.showDesktopView=m,t.enableFullscreenPreview=p,t.disableFullscreenPreview=f,t.getPreviewMode=h,t.removeLeftSideToolBar=i,t.removeMainToolBar=c,t.removeRightSideToolBar=u}),define("nohost/HTMLServer",["require","exports","module","lib/compatibility","lib/MouseManager","lib/PostMessageTransport","lib/LinkManager"],function(e,t,n){"use strict";function r(e){return l.isStaticHtmlFileExt(e)}function o(e){return c.isCSS(p.extname(e))}function a(e){e=e||{},i.call(this,e)}var s,i=brackets.getModule("LiveDevelopment/Servers/BaseServer").BaseServer,l=brackets.getModule("LiveDevelopment/LiveDevelopmentUtils"),c=brackets.getModule("filesystem/impls/filer/lib/content"),u=brackets.getModule("filesystem/impls/filer/BlobUtils"),d=brackets.getModule("filesystem/impls/filer/BracketsFiler"),p=d.Path,f=brackets.getModule("filesystem/impls/filer/lib/HTMLRewriter"),m=brackets.getModule("filesystem/impls/filer/lib/CSSRewriter"),b=e("lib/compatibility"),g=(e("lib/MouseManager"),e("lib/PostMessageTransport")),v=(e("lib/LinkManager"),d.fs());a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype.pathToUrl=function(e){return u.getUrl(e)},a.prototype.urlToPath=function(e){return c.isBlobURL(e)||c.isRelativeURL(e)?u.getFilename(e):null},a.prototype.readyToServe=function(){var e=new $.Deferred;return b.supportsIFrameHTMLBlobURL(function(t,n){t&&(console.error("[Brackets HTMLServer] Unexpected error:",t),e.reject()),s=n,e.resolve()}),e.promise()},a.prototype.canServe=function(e){return e===this._pathResolver(e)?!1:e.match(/\/$/)?!0:r(e)},a.prototype.add=function(e){e.setInstrumentationEnabled&&e.setInstrumentationEnabled(!0),i.prototype.add.call(this,e)},a.prototype.serveLiveDocForUrl=function(e,t){var n=u.getFilename(e);this.serveLiveDocForPath(n,t)},a.prototype.serveLiveDocForPath=function(e,t){function n(e,t,n){var r=u.getUrl(e);return r!==e?void n(null,r):void m.rewrite(e,t,function(t,r){return t?void n(t):void n(null,u.createURL(e,r,"text/css"))})}function a(e,t,n,r){f.rewrite(e,t,n,function(t,n){return t?void r(t):void r(null,s?u.createURL(e,n,"text/html"):n)})}function i(s){r(e)?a(e,s,l,t):o(e)?n(e,s,t):t(new Error("[Brackets HTMLServer] expected .html or .css live doc type:"+e))}var l=this,c=this.get(e);c?i(c.getResponseData().body):v.readFile(e,"utf8",function(n,o){if(n)return t(n);if(r(e)){var a=g.getRemoteScript(e),s=a+"$&",l=new RegExp(/<\/\s*head>/),c=new RegExp(/<\/\s*html>/);l.test(o)?o=o.replace(l,s):c.test(o)?o=o.replace(c,s):o+=a}i(o)})},t.HTMLServer=a}),define("nohost/main",["require","exports","module","nohost/HTMLServer"],function(e,t,n){"use strict";function r(){return a||(a=new l({pathResolver:i.makeProjectRelativeIfPossible,root:i.getProjectRoot()})),a}function o(){s.registerServer({create:r},9001)}var a,s=brackets.getModule("LiveDevelopment/LiveDevServerManager"),i=brackets.getModule("project/ProjectManager"),l=e("nohost/HTMLServer").HTMLServer;t.init=o,t.getHTMLServer=r}),define("lib/BrambleCodeSnippets",["require","exports","module"],function(e,t,n){"use strict";function r(){function e(e){var t=a.getFocusedEditor();if(t){var n=t.getCursorPos();t.document.replaceRange(e,n)}}o.registerInternal(s,e)}var o=brackets.getModule("command/CommandManager"),a=brackets.getModule("editor/EditorManager"),s="bramble.addCodeSnippet";t.init=r}),define("lib/xhr/XHRHandler",["require","exports","module","lib/PostMessageTransport"],function(e,t,n){"use strict";var r=brackets.getModule("filesystem/impls/filer/BracketsFiler").fs(),o=e("lib/PostMessageTransport");n.exports.handleRequest=function(e){var t={method:"XMLHttpRequest"};r.readFile(e,"utf8",function(n,r){n?"ENOENT"===n.code?(t.error="No resource found for `"+e+"`",t.status=404):(t.error="Could not complete the request",t.status=500):t.content=r,o.send(null,JSON.stringify(t))})}}),define("lib/SVGUtils",["require","exports","module"],function(e,t,n){"use strict";function r(e){var t=new $.Deferred;return e.isDirty?(u.get(c.FILE_SAVE).execute({doc:e}).then(t.resolve,t.reject),t.promise()):t.resolve().promise()}function o(e){return u.get(c.FILE_CLOSE).execute({file:e,_closeOptions:{noOpenNextFile:!0}})}function a(e){return u.get(c.FILE_OPEN).execute({fullPath:e.fullPath})}function s(e,t){return o(e).done(function(){a(e).then(t.resolve,t.reject)}).fail(t.reject),t.promise()}function i(e){var t=new $.Deferred,n=p.getOpenDocumentForPath(e.fullPath);return n?(r(n).done(function(){s(e,t)}).fail(t.reject),t.promise()):s(e,t)}function l(e){var t=d.getAllOpenFiles().filter(function(e){var t=e.fullPath;return".svg"===b.extname(t).toLowerCase()});m.doSequentially(t,i,!1).then(e)}var c=brackets.getModule("command/Commands"),u=brackets.getModule("command/CommandManager"),d=brackets.getModule("view/MainViewManager"),p=brackets.getModule("document/DocumentManager"),f=brackets.getModule("preferences/PreferencesManager"),m=brackets.getModule("utils/Async"),b=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path;f.definePreference("openSVGasXML","boolean",!1),t.showXML=function(e){f.set("openSVGasXML",!0),l(e)},t.showImage=function(e){f.set("openSVGasXML",!1),l(e)}}),define("lib/RemoteCommandHandler",["require","exports","module","lib/SVGUtils","lib/MouseManager","lib/PostMessageTransport","lib/Tutorial","lib/Theme","lib/UI"],function(e,t,n){"use strict";function r(e){return function(){var t={type:"bramble:remoteCommand:callback",callback:e};parent.postMessage(JSON.stringify(t),"*")}}function o(e,t,n){function r(){t.unshift(c[e]),i.execute.apply(null,t).always(n)}switch(e){case"EDIT_UNDO":case"EDIT_REDO":case"VIEW_INCREASE_FONT_SIZE":case"VIEW_DECREASE_FONT_SIZE":case"VIEW_RESTORE_FONT_SIZE":var o=l.getActiveEditor();o&&!o.hasFocus()?(o.one("focus",r),o.focus()):r();break;default:r()}}function a(e,t,n){var r=!1;switch(e){case"BRAMBLE_RELOAD":u.forceScriptsOnce(),w.reload(!0);break;case"BRAMBLE_MOBILE_PREVIEW":_.showMobileView();break;case"BRAMBLE_DESKTOP_PREVIEW":_.showDesktopView();break;case"BRAMBLE_ENABLE_FULLSCREEN_PREVIEW":_.enableFullscreenPreview();break;case"BRAMBLE_DISABLE_FULLSCREEN_PREVIEW":_.disableFullscreenPreview();break;case"BRAMBLE_ENABLE_AUTO_UPDATE":b.set("autoUpdate",!0),w.setAutoUpdate(!0);break;case"BRAMBLE_DISABLE_AUTO_UPDATE":b.set("autoUpdate",!1),w.setAutoUpdate(!1);break;case"BRAMBLE_ENABLE_SCRIPTS":b.set("allowJavaScript",!0),w.reload();break;case"BRAMBLE_DISABLE_SCRIPTS":b.set("allowJavaScript",!1),w.reload();break;case"BRAMBLE_ENABLE_INSPECTOR":M.enableInspector();break;case"BRAMBLE_ENABLE_AUTOCOMPLETE":b.set("codehint.TagHints",!0),b.set("codehint.AttrHints",!0),b.set("codehint.JSHints",!0),b.set("codehint.CssPropHints",!0);break;case"BRAMBLE_DISABLE_AUTOCOMPLETE":b.set("codehint.TagHints",!1),b.set("codehint.AttrHints",!1),b.set("codehint.JSHints",!1),b.set("codehint.CssPropHints",!1);break;case"BRAMBLE_DISABLE_INSPECTOR":M.disableInspector(!0);break;case"BRAMBLE_LIGHT_THEME":y.setTheme("light-theme");break;case"BRAMBLE_DARK_THEME":y.setTheme("dark-theme");break;case"BRAMBLE_SHOW_SIDEBAR":d.show();break;case"BRAMBLE_HIDE_SIDEBAR":d.hide();break;case"BRAMBLE_HIDE_STATUSBAR":p.disable();break;case"BRAMBLE_SHOW_STATUSBAR":p.enable();break;case"BRAMBLE_ENABLE_WORD_WRAP":b.set("wordWrap",!0);break;case"BRAMBLE_DISABLE_WORD_WRAP":b.set("wordWrap",!1);break;case"BRAMBLE_CONFIGURE_AUTO_CLOSE_TAGS":b.set("closeTags",t[0]);break;case"BRAMBLE_OPEN_SVG_AS_XML":r=!0,h.showXML(n);break;case"BRAMBLE_OPEN_SVG_AS_IMAGE":r=!0,h.showImage(n);break;case"BRAMBLE_SHOW_TUTORIAL":L.setOverride(!0);break;case"BRAMBLE_HIDE_TUTORIAL":L.setOverride(!1);break;case"BRAMBLE_SHOW_UPLOAD_FILES_DIALOG":r=!0,i.execute("bramble.showUploadFiles").always(n);break;case"BRAMBLE_ADD_NEW_FILE":r=!0,i.execute("bramble.addFile",t[0]).always(n);break;case"BRAMBLE_EXPORT":r=!0,v.archive(n);break;case"RESIZE":f.recomputeLayout(!0),m.triggerUpdateLayoutEnd();break;case"BRAMBLE_ADD_CODE_SNIPPET":r=!0,i.execute("bramble.addCodeSnippet",t[0]).always(n);break;default:console.log("[Bramble] unknown command:",e),r=!0}r||n()}function s(e){var t;try{t=JSON.parse(e.data)}catch(n){return void console.log("[Bramble] unable to parse remote request:",e.data)}if("bramble:remoteCommand"===t.type){var s=t.args;switch(g.isArray(s)||(s=[s]),t.commandCategory){case"brackets":o(t.command,s,r(t.callback));break;case"bramble":a(t.command,s,r(t.callback));break;default:console.error("[Bramble] unknown remote command request:",t)}}}var i=brackets.getModule("command/CommandManager"),l=brackets.getModule("editor/EditorManager"),c=brackets.getModule("command/Commands"),u=brackets.getModule("filesystem/impls/filer/lib/HTMLRewriter"),d=brackets.getModule("project/SidebarView"),p=brackets.getModule("widgets/StatusBar"),f=brackets.getModule("view/WorkspaceManager"),m=brackets.getModule("bramble/BrambleEvents"),b=brackets.getModule("preferences/PreferencesManager"),g=brackets.getModule("thirdparty/lodash"),v=brackets.getModule("filesystem/impls/filer/ArchiveUtils"),h=e("lib/SVGUtils"),M=e("lib/MouseManager"),w=e("lib/PostMessageTransport"),L=e("lib/Tutorial"),y=e("lib/Theme"),_=e("lib/UI");t.handleRequest=s}),define("lib/RemoteEvents",["require","exports","module","lib/UI","lib/Theme"],function(e,t,n){"use strict";function r(e){parent.postMessage(JSON.stringify(e),"*")}function o(){var e=$("#first-pane"),t=$("#second-pane"),n=$("#sidebar");r({type:"bramble:layout",sidebarWidth:n.is(":visible")?n.width():0,firstPaneWidth:e?e.width():0,secondPaneWidth:t?t.width():0})}function a(e){var t=e.fullPath,n=d.basename(t);r({type:"bramble:activeEditorChange",fullPath:t,filename:n})}function s(){l.on("bramble:updateLayoutStart",o),l.on("bramble:updateLayoutEnd",o),l.on("bramble:previewModeChange",function(e,t){r({type:"bramble:previewModeChange",mode:t})}),l.on("bramble:sidebarChange",function(e,t){r({type:"bramble:sidebarChange",visible:t})}),l.on("bramble:projectDirty",function(e,t){r({type:"bramble:projectDirty",path:t})}),l.on("bramble:projectSaved",function(e){r({type:"bramble:projectSaved"})});var e;c.on("currentFileChange",function(t,n){n&&n.fullPath!==e&&(e=n.fullPath,a(n))}),l.on("fileRenamed",function(t,n,r){n===e&&(e=r,a({fullPath:r}))}),l.on("bramble:themeChange",function(e,t){r({type:"bramble:themeChange",theme:t})}),l.on("bramble:tutorialVisibilityChange",function(e,t){r({type:"bramble:tutorialVisibilityChange",visible:t})}),l.on("bramble:inspectorChange",function(e,t){r({type:"bramble:inspectorChange",enabled:t})}),u.on("fontSizeChange",function(e,t){r({type:"bramble:fontSizeChange",fontSize:t})}),p.on("change","wordWrap",function(){r({type:"bramble:wordWrapChange",wordWrap:p.get("wordWrap")})}),p.on("change","closeTags",function(){r({type:"bramble:autoCloseTagsChange",autoCloseTags:p.get("closeTags")})}),p.on("change","allowJavaScript",function(){r({type:"bramble:allowJavaScriptChange",allowJavaScript:p.get("allowJavaScript")})}),p.on("change","codehint.TagHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.TagHints")})}),p.on("change","codehint.AttrHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.AttrHints")})}),p.on("change","codehint.JSHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.JSHints")})}),p.on("change","codehint.CssPropHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.CssPropHints")})}),p.on("change","autoUpdate",function(){r({type:"bramble:autoUpdateChange",autoUpdate:p.get("autoUpdate")})}),p.on("change","openSVGasXML",function(){r({type:"bramble:openSVGasXMLChange",openSVGasXML:p.get("openSVGasXML")})})}function i(){var e=c.getCurrentlyViewedFile(),t="",n="";e&&(t=e.fullPath,n=d.basename(t));var o=$("#first-pane"),a=$("#second-pane"),s=$("#sidebar");r({type:"bramble:loaded",sidebarVisible:s.is(":visible"),sidebarWidth:s.is(":visible")?s.width():0,firstPaneWidth:o?o.width():0,secondPaneWidth:a?a.width():0,fullPath:t,filename:n,previewMode:f.getPreviewMode(),fontSize:u.getFontSize(),theme:m.getTheme(),wordWrap:p.get("wordWrap"),autoCloseTags:p.get("closeTags"),autoUpdate:p.get("autoUpdate"),openSVGasXML:p.get("openSVGasXML"),allowJavaScript:p.get("allowJavaScript")})}var l=brackets.getModule("bramble/BrambleEvents"),c=brackets.getModule("view/MainViewManager"),u=brackets.getModule("view/ViewCommandHandlers"),d=brackets.getModule("filesystem/impls/filer/FilerUtils").Path,p=brackets.getModule("preferences/PreferencesManager"),f=e("lib/UI"),m=e("lib/Theme");t.start=s,t.loaded=i}),define("main",["require","exports","module","lib/iframe-browser","lib/UI","lib/launcher","nohost/main","lib/BrambleCodeSnippets","lib/PostMessageTransport","lib/xhr/XHRHandler","lib/Theme","lib/RemoteCommandHandler","lib/RemoteEvents"],function(e,t,n){"use strict";function r(e){try{return e=JSON.parse(e||null),e||{}}catch(t){return!1}}function o(e){var t,n=v.getBrowserIframe().src,o=S.getFilename(n),a=o!==n?k.dirname(o):o;try{e=r(e)}catch(s){return void console.error("[Brackets Browser LiveDev Error] Cannot handle message ",e)}"XMLHttpRequest"===e.method&&(t=k.resolve(a,k.normalize(e.path)),T.handleRequest(t))}function a(){v.init();var e=u.getExtensionPrefs("livedev");e.set("multibrowser",!0),w.init(),_.setIframe(v.getBrowserIframe()),d.setTransport(_),d.setLauncher(new M({browser:v,server:w.getHTMLServer()})),d.open()}function s(e){e&&console.warn("Unable to preload filesystem URLs",e),u.set("insertHintOnTab",!0),u.set("spaceUnits",2),u.set("tabSize",2),u.setViewState("splitview.multipane-info",!0),window.addEventListener("message",function(e){var t=r(e.data);if(t){var n=t.type;return"message"===n?void o(t.message):"themeToggle"===n?void B.toggle(t.theme):void 0}},!1),x.loaded()}function i(){var e=p.project("root"),t=p.project("filename");f.openProject(e).always(function(){var e=new $.Deferred;g.resolve(t,function(t,n){if(t)e.reject();else{var r=m.execute(b.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:n.fullPath});r.then(e.resolve,e.reject)}}),e.always(function(){E.refresh(function(e){e&&console.warn("[Bramble] unable to preload all filesystem Blob URLs",e),c._dispatchReady(c.APP_READY),a(),L.init(),h.initUI(s)})})})}function l(e){var t=r(e.data);t&&"bramble:init"===t.type&&(window.removeEventListener("message",l,!1),window.addEventListener("message",R.handleRequest,!1),p.project.init({root:t.mount.root,filename:t.mount.filename}),p.ui.init({fontSize:t.state.fontSize,theme:t.state.theme,sidebarVisible:t.state.sidebarVisible,sidebarWidth:t.state.sidebarWidth,firstPaneWidth:t.state.firstPaneWidth,secondPaneWidth:t.state.secondPaneWidth,previewMode:t.state.previewMode,wordWrap:t.state.wordWrap,allowAutocomplete:t.state.allowAutocomplete,autoCloseTags:t.state.autoCloseTags,autoUpdate:t.state.autoUpdate,openSVGasXML:t.state.openSVGasXML,allowJavaScript:t.state.allowJavaScript}),x.start(),i())}var c=brackets.getModule("utils/AppInit"),u=brackets.getModule("preferences/PreferencesManager"),d=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),p=brackets.getModule("bramble/StartupState"),f=brackets.getModule("project/ProjectManager"),m=brackets.getModule("command/CommandManager"),b=brackets.getModule("command/Commands"),g=brackets.getModule("filesystem/FileSystem"),v=e("lib/iframe-browser"),h=e("lib/UI"),M=e("lib/launcher"),w=e("nohost/main"),L=e("lib/BrambleCodeSnippets"),y=brackets.getModule("utils/ExtensionUtils"),_=e("lib/PostMessageTransport"),k=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,E=brackets.getModule("filesystem/impls/filer/FileSystemCache"),S=brackets.getModule("filesystem/impls/filer/BlobUtils"),T=e("lib/xhr/XHRHandler"),B=e("lib/Theme"),R=e("lib/RemoteCommandHandler"),x=e("lib/RemoteEvents");y.loadStyleSheet(n,"stylesheets/style.css"),y.loadStyleSheet(n,"stylesheets/sidebarTheme.css"),window.addEventListener("message",l,!1),window.parent.postMessage(JSON.stringify({type:"bramble:readyToMount"}),"*")});