define("text",["module"],function(e){"use strict";var t,n,r,i,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,u=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,f=c&&(location.port||void 0),g={},p=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(l,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(r){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,r=n||t,o=r.indexOf("!"),-1!==o&&(i="strip"===r.substring(o+1),r=r.substring(0,o),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var o,a,l,s=t.xdRegExp.exec(e);return s?(o=s[2],a=s[3],a=a.split(":"),l=a[1],a=a[0],!(o&&o!==n||a&&a.toLowerCase()!==r.toLowerCase()||(l||a)&&l!==i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(g[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText)return void r();p.isBuild=i.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),l=n.toUrl(a),s=p.useXhr||t.useXhr;return 0===l.indexOf("empty:")?void r():void(!c||s(l,u,d,f)?t.get(l,function(n){t.finishLoad(e,o.strip,n,r)},function(e){r.error&&r.error(e)}):n([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,r)}))},write:function(e,n,r,i){if(g.hasOwnProperty(n)){var o=t.jsEscape(g[n]);r.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,r,i,o){var a=t.parseName(n),l=a.ext?"."+a.ext:"",s=a.moduleName+l,c=r.toUrl(a.moduleName+l)+".js";t.load(s,r,function(n){var r=function(e){return i(c,e)};r.asModule=function(e,t){return i.asModule(e,c,t)},t.write(e,s,r,o)},o)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");0===i.indexOf("\ufeff")&&(i=i.substring(1)),t(i)}catch(o){r(o)}}):"xhr"===p.env||!p.env&&t.createXhr()?t.get=function(e,n,r,i){var o,a=t.createXhr();if(a.open("GET",e,!0),i)for(o in i)i.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(a,e),a.onreadystatechange=function(t){var i,o;4===a.readyState&&(i=a.status,i>399&&600>i?(o=new Error(e+" HTTP status: "+i),o.xhr=a,r(o)):n(a.responseText),p.onXhrComplete&&p.onXhrComplete(a,e))},a.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,r,i="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),l=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),i)),s="";try{for(n=new java.lang.StringBuffer,r=l.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&n.append(r);null!==(r=l.readLine());)n.append(a),n.append(r);s=String(n.toString())}finally{l.close()}t(s)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,a,l,s={};o&&(e=e.replace(/\//g,"\\")),l=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(l,1,0,!1),a=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),a.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),s),a.close(),n.close(),t(s.value)}catch(c){throw new Error((l&&l.path||"")+": "+c)}}),t}),define("text!QuickViewTemplate.html",[],function(){return'<div id="quick-view-container">\n    <div class="preview-content">\n    </div>\n</div>'}),define("main",["require","exports","module","text!QuickViewTemplate.html"],function(e,t,n){"use strict";function r(){G&&(G.visible?(G.marker.clear(),E.empty(),w.hide(),w.removeClass("active")):window.clearTimeout(G.hoverTimer),G=null)}function i(e,t,n,r){var i=w.outerWidth(),o=n-w.outerHeight()-W,a=t-i/2,l={top:o,left:a-D,height:w.outerHeight()+W,width:i+2*D},s=A.getElementClipSize($(e.getRootElement()),l);s.left>0?a+=s.left:s.right>0&&(a-=s.right),s.top>0?(o=r+W,w.removeClass("preview-bubble-above").addClass("preview-bubble-below")):w.removeClass("preview-bubble-below").addClass("preview-bubble-above"),w.css({left:a,top:o}).addClass("active")}function o(e,t){var n=e.offset();return t.clientX>=n.left&&t.clientX<=n.left+e.width()&&t.clientY>=n.top&&t.clientY<=n.top+e.height()}function a(e,t,n,r){function i(e){var t,n,r=0;for(p&&(e=S.reduceStyleSheetForRegExParsing(e)),n=e.length,t=0;n>t;t++)switch(e[t]){case"(":r++;break;case")":r--;break;case"\\":t++}return 0===r}function o(e,t){var n,r=t?d.exec(e):null,i="";return r&&(-1!==r[0].indexOf("@")?r=null:(r[0].match(/-o-|-moz-|-ms-|-webkit-/i)&&(i="-webkit-"),r[1]?n=r[1]+r[5]:r[3]?n=r[3]+r[5]:r[0]&&(n=r[0],i=""))),{match:r,prefix:i,colorValue:n}}function a(e,t,n){function r(e,t){var n,r;if(e){if(n=e.index-1,n>=0&&"-"===t[n])return!0;if(r=e.index+e[0].length,r<t.length&&"-"===t[r])return!0}return!1}function i(e){return e&&e[0]&&/^[a-z]+$/i.test(e[0])?!0:void 0}var o,a;do{if(o=f.exec(t),!o)break;if(void 0===a){var l=F.getModeAt(e._codeMirror,n,!1).name;a=-1===Q.indexOf(l)}}while(r(o,t)||a&&i(o));return o}function l(e){var t=/((?:[^"']|".*?"|'.*?')*?)([(,)]|$)/g,n=function(){for(var r=[];;){var i=t.exec(e);if("("===i[2]){var o=i[1].trim()+"("+n().join(",")+")";i=t.exec(e),o+=i[1],r.push(o)}else r.push(i[1].trim());if(","!==i[2])return r}};return n()}function s(e){return e.length>0&&null!==e[0].match(f)}function c(e){return e.length>1&&e[1].indexOf("px")>0}function u(e){if(e.indexOf("px")>0){var t,n,r,i=e.indexOf("(")+1,o=e.lastIndexOf(")"),a=e.substring(i,o),u=l(a),d=0,f=w.width();for(r=0;r<u.length;r++)t=u[r].split(" "),c(t)&&(n=parseFloat(t[1]),f=Math.max(f,n),0>n&&(d=Math.min(d,n)));for(d=Math.abs(d),f+=d,r=0;r<u.length;r++)t=u[r].split(" "),s(t)&&c(t)&&(n=0===f?0:(parseFloat(t[1])+d)/f*100,t[1]=n+"%"),u[r]=t.join(" ");e=e.substring(0,i)+u.join(", ")+e.substring(o)}return e}for(var d=/-webkit-gradient\((?:[^\(]*?(?:\((?:[^\(]*?(?:\([^\)]*?\))*?)*?\))*?)*?\)|(?:(?:-moz-|-ms-|-o-|-webkit-|:|\s)((repeating-)?linear-gradient)|(?:-moz-|-ms-|-o-|-webkit-|:|\s)((repeating-)?radial-gradient))(\((?:[^\)]*?(?:\([^\)]*?\))*?)*?\))/gi,f=new RegExp(y.COLOR_REGEX),g=F.getModeAt(e._codeMirror,t,!1),p=-1!==Q.indexOf(g),v=i(r),m=o(r,v),h=m.match||a(e,r,t),b=e._codeMirror;h;){if(t.ch<h.index){if(!m.match)break;m={match:null,prefix:"",colorValue:null}}else if(t.ch<=h.index+h[0].length){var x=m.prefix+(m.colorValue||h[0]);x=u(x);var E,M="<div class='color-swatch' style='background:"+x+"'></div>",k={line:t.line,ch:h.index},C={line:t.line,ch:h.index+h[0].length},I=b.charCoords(k);return E=(b.charCoords(C).left-I.left)/2+I.left,{start:k,end:C,content:M,xpos:E,ytop:I.top,ybot:I.bottom,_previewCSS:x}}m.match&&(m=o(r,v)),h=m.match||a(e,r,t)}return null}function l(e,t,n,o){var a,l,s=e._codeMirror,c=/url\(([^\)]*)\)/gi;if("string"===n.type)a=n.string;else for(l=c.exec(o);l&&!(t.ch<l.index);){if(t.ch<=l.index+l[0].length){a=l[1];break}l=c.exec(o)}if(!a)return null;a=a.replace(/(^['"])|(['"]$)/g,"");var u,d,f,g=e.document.file.fullPath,p=U.parseUrl(a),v=""!==p.protocol&&-1!==Y.indexOf(p.protocol.trim().toLowerCase()),m=p.filenameExtension.replace(/^\./,""),h=R.getLanguageForExtension(m),b=h&&h.getId(),x="image"===b||"svg"===b;if(v&&(x||!m&&C)?f=a:!v&&x&&(f=V.getUrl(j.join(_.getDirectoryPath(g),a))),!f)return null;l?(u={line:t.line,ch:l.index},d={line:t.line,ch:l.index+l[0].length}):(u={line:t.line,ch:n.start},d={line:t.line,ch:n.end});var M="<div class='image-preview'>    <img src=\""+f+'"></div>',k=s.charCoords(u),y=(s.charCoords(d).left-k.left)/2+k.left,I=function(){w.hide(),w.find(".image-preview > img").on("load",function(){E.append("<div class='img-size'>"+this.naturalWidth+" &times; "+this.naturalHeight+" "+N.UNIT_PIXELS+"</div>"),w.show(),i(e,G.xpos,G.ytop,G.ybot)}).on("error",function(e){e.preventDefault(),r()})};return{start:u,end:d,content:M,onShow:I,xpos:y,ytop:k.top,ybot:k.bottom,_imgPath:f}}function s(e,t,n){var r=e.document.getLine(t.line),i=a(e,t,n,r)||l(e,t,n,r);return i?(i.visible=!1,i.editor=e,i):null}function c(e){var t=T.getCurrentFullEditor();if(t&&e){var n,r,i=t.getInlineWidgets();for(n=0;n<i.length;n++){var a=i[n].editor&&$(i[n].editor.getRootElement()),l=i[n].$htmlContent;if(a&&o(a,e)){r=i[n].editor;break}if(l&&o(l,e))return}return r||o($(t.getRootElement()),e)&&(r=t),r}}function u(e,t){var n,o;if(e||(e=c(M)),!e||!e._codeMirror)return void r();o=e._codeMirror;var a=o.coordsChar({left:M.clientX,top:M.clientY});a.ch>=e.document.getLine(a.line).length||(t?G=t:(n=F.getTokenAt(o,a),G=$.extend({},G,s(e,a,n))),G&&G.start&&G.end&&(G.marker=o.markText(G.start,G.end,{className:"quick-view-highlight"}),E.append(G.content),w.show(),G.visible=!0,G.onShow?G.onShow():i(e,G.xpos,G.ytop,G.ybot)))}function d(){if(k=null,M){var e=!1,t=null;if(G&&G.visible){if(t=c(M),t&&t._codeMirror){var n=t._codeMirror,i=n.coordsChar({left:M.clientX,top:M.clientY});if(G.start&&G.end&&t.posWithinRange(i,G.start,G.end,!0)&&i.ch<t.document.getLine(i.line).length)return}e=!0}r(),G={},G.hoverTimer=window.setTimeout(function(){u(t)},e?0:z)}}function f(e){if(M=null,x){if(e.which)return void r();M={clientX:e.clientX,clientY:e.clientY},k||(k=window.requestAnimationFrame(d))}}function g(e,t,n){r(),n&&n.document&&n.document.off("change",r),t&&t.document&&t.document.on("change",r)}function p(){I.get(H).setChecked(x)}function v(e,t){C!==e&&(C=e,t||(B.set("extensionlessImagePreview",x),B.save()))}function m(e,t){if(x!==e){x=e;var n=$("#editor-holder")[0];x?(n.addEventListener("mousemove",f,!0),n.addEventListener("scroll",r,!0),n.addEventListener("mouseout",r,!0),g(null,T.getActiveEditor(),null),T.on("activeEditorChange",g)):(n.removeEventListener("mousemove",f,!0),n.removeEventListener("scroll",r,!0),n.removeEventListener("mouseout",r,!0),g(null,null,T.getActiveEditor()),T.off("activeEditorChange",g),r()),t||(B.set("enabled",x),B.save())}p()}function h(){m(!x)}function b(e){r(),M={clientX:e.xpos,clientY:Math.floor((e.ybot+e.ytop)/2)},u(e.editor,e)}var x,w,E,M,k,C,y=brackets.getModule("utils/ColorUtils"),I=brackets.getModule("command/CommandManager"),L=brackets.getModule("command/Commands"),S=brackets.getModule("language/CSSUtils"),T=brackets.getModule("editor/EditorManager"),P=brackets.getModule("utils/ExtensionUtils"),_=brackets.getModule("file/FileUtils"),X=brackets.getModule("command/Menus"),O=brackets.getModule("preferences/PreferencesManager"),R=brackets.getModule("language/LanguageManager"),N=brackets.getModule("strings"),A=brackets.getModule("utils/ViewUtils"),F=brackets.getModule("utils/TokenUtils"),U=brackets.getModule("thirdparty/path-utils/path-utils"),j=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,V=brackets.getModule("filesystem/impls/filer/BlobUtils"),q=e("text!QuickViewTemplate.html"),B=null,H="view.enableQuickView",z=350,W=15,D=5,Q=["css","text/x-less","sass","text/x-scss","stylus"],Y=["data:","http:","https:","ftp:","file:"];B=O.getExtensionPrefs("quickview"),B.definePreference("enabled","boolean",!0,{description:N.DESCRIPTION_QUICK_VIEW_ENABLED}),B.definePreference("extensionlessImagePreview","boolean",!0,{description:N.DESCRIPTION_EXTENSION_LESS_IMAGE_PREVIEW});var G=null;w=$(q).appendTo($("body")),E=w.find(".preview-content"),P.loadStyleSheet(n,"QuickView.css"),I.register(N.CMD_ENABLE_QUICK_VIEW,H,h),X.getMenu(X.AppMenuBar.VIEW_MENU).addMenuItem(H,null,X.AFTER,L.VIEW_TOGGLE_INSPECTION),m(B.get("enabled"),!0),v(B.get("extensionlessImagePreview"),!0),B.on("change","enabled",function(){m(B.get("enabled"),!0)}),B.on("change","extensionlessImagePreview",function(){v(B.get("extensionlessImagePreview"))}),t._queryPreviewProviders=s,t._forceShow=b});